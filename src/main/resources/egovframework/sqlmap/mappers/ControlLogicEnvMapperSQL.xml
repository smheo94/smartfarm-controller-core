<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.kt.smartfarm.supervisor.mapper.ControlLogicMapper">
	<select id="getLogicList" resultType="controlLogicVO">
		SELECT 
			id, 
			name, 
			java_class_name,
			ui_class_name,
			description, 
			ui_help,
			can_multi_logic,
			default_period_size
		FROM control_logic
	</select>

	<select id="getLogicDeviceList" resultType="controlLogicDeviceVO">
		SELECT 
			id, 
			logic_id,
			device_num,
			device_param_name,
			device_type,
			is_main,
			required, 
			able_array,
			description, 
			display_order,
			is_used
		FROM control_logic_device
		<where>
			<if test="logicId != null">
				AND logic_id = #{logicId}
			</if>
		</where>
		ORDER BY logic_id, device_num
	</select>

	<select id="getLogicPropertyList" resultType="map" >
		SELECT
			id,
			ui_class_name,
			description,
			ui_help,
			properties_json,
			min_value,
			max_value,
			display_unit,
			default_value,
			default_min_value,
			default_max_value,
			bootstrap_size,
			dep_class_comp_up,
			dep_class_comp_down,
			logic_id,
			properties_id,
			is_period,
			priority,
			on_pc,
			on_mobile,
			on_panel
		FROM control_properties
		INNER JOIN control_logic_property_lnk clpl ON clpl.properties_id = control_properties.id
		<where>
			<if test="logicId != null">
				AND control_properties.logic_id = #{logicId}
			</if>
		</where>
		ORDER BY is_period, priority
	</select>
	
</mapper>
