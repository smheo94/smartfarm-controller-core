<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.kt.smartfarm.supervisor.mapper.ControlLogicMapper">
	<select id="getLogicList" resultType="controlLogicVO">
		SELECT 
			id, 
			name, 
			java_class_name AS javaClassName, 
			ui_class_name AS uiClassName, 
			description, 
			ui_help AS uiHelp, 
			can_multi_logic AS canMultiLogic, 
			default_period_size AS defaultPeriodSize
		FROM control_logic
	</select>

	<select id="getLogicDeviceList" resultType="controlLogicDeviceVO">
		SELECT 
			id, 
			logic_id AS logicId,
			device_num AS deviceNum,
			device_param_name AS deviceParamName,
			device_type AS deviceType,
			is_main AS isMain,
			required, 
			able_array AS ableArray, 
			description, 
			display_order AS displayOrder, 
			is_used AS isUsed
		FROM control_logic_device
		<where>
			<if test="logicId != null">
				AND logic_id = #{logicId}
			</if>
		</where>
		ORDER BY logic_id, device_num
	</select>

	<select id="getLogicPropertyList" resultType="map" >
		SELECT
			id,
			ui_class_name AS uiClassName,
			description,
			ui_help AS uiHelp,
			properties_json AS propertiesJson,
			min_value AS minValue,
			max_value AS `maxValue`,
			display_unit AS displayUnit,
			default_value AS defaultValue,
			default_min_value AS defaultMinValue,
			default_max_value AS defaultMaxValue,
			bootstrap_size AS bootstrapSize,
			dep_class_comp_up AS depClassCompUp,
			dep_class_comp_down AS depClassCompDown,
			logic_id AS logicId,
			properties_id AS propertiesId,
			is_period AS isPeriod,
			priority,
			on_pc AS onPc,
			on_mobile AS onMobile,
			on_panel AS onPanel
		FROM control_properties
		<where>
			<if test="logicId != null">
				AND logic_id = #{logicId}
			</if>
		</where>
		INNER JOIN control_logic_property_lnk clpl ON clpl.properties_id = control_properties.id
		ORDER BY is_period, priority
	</select>
	
</mapper>
